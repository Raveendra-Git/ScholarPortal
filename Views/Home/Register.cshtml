<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" href="~/Images/favicon.png" />
    <title>Register</title>

    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.bootcss.com/select2/3.4.5/select2.min.css" rel="stylesheet" />
    <link href="~/Content/toast.css" rel="stylesheet" />

    <style class="text/css">

        dl, ol, ul {
            margin-top: 0;
            margin-bottom: 0 !important;
        }

        .help-block {
            color: red;
        }

        div .position-absolute {
            right: 36px;
            bottom: 0;
        }

        .clsbtn {
            float: right;
            padding: 9px;
            width: 74px;
            font-weight: bolder;
            font-size: medium;
            margin: 5px;
        }

        h2 {
            color: mediumblue;
        }

        #female, #other {
            margin-left: 16px;
        }

        .clspadd {
            padding-top: 20px;
        }

        input[name="language"] {
            margin-left: 6px;
        }

        .clscheck {
            width: 73%;
        }

        marquee {
            color: darkmagenta;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3">
                <h2>Enter your Information</h2>
            </div>
            <div class="col-sm-9">
                <marquee width="85%" direction="left" height="30px">
                    Please Make sure all the information you provide are valid.
                </marquee>
            </div>
        </div>

        <div class="card">
          
                <form id="form-register">
                    <div id="divMain" class="mrg10B mrg20T col-sm-12 col-xs-12 pad0A">

                        <div class="row pad10A">
                            <div class="col-sm-12 main-page">
                                <div class="row form1 hide">
                                    <div class="col-sm-6 clspadd">
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label class="control-label">First Name <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="text" name="name" id="txtfName" class="form-control" data-validation-required-message="First Name is required" required value="Robert"/>                                                                                                                
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="help-block"></div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label class="control-label">Last Name <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="text" name="name" id="txtlName" class="form-control" value="Kiyoshki" data-validation-required-message="Last Name is required" required />
                                                        <div class="help-block"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        @*<div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>DOB<span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input id="dtDOB" class="form-control clstxtfield-md" autocomplete="off" data-validation-required-message="DOB is required" data-toggle="datepicker" maxlength="10" required>
                                                        <div class="help-block"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>*@
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>Email <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="email" name="email" id="txtEmail" class="form-control" value="robert@gmaiol.com" data-validation-required-message="Email is required" required />
                                                        <div class="help-block"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>Phone No : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <input type="number" name="number" id="txtPhNo" class="form-control" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>Gender : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <input type="radio" name="gender" id="male" value="1" checked/>
                                                        <label for="male">Male</label>
                                                        <input type="radio" name="gender" id="female" value="2" />
                                                        <label for="female">Female</label>
                                                        <input type="radio" name="gender" id="other" value="0" />
                                                        <label for="other">Other</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>Languages known : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <input type="checkbox" name="language" value="1" id="english" />
                                                        <label for="english">English</label>
                                                        <input type="checkbox" name="language" value="2" id="kannada" />
                                                        <label for="kannada">Kannada</label>
                                                        <input type="checkbox" name="language" value="3" id="hindi" />
                                                        <label for="hindi">Hindi</label>
                                                        <input type="checkbox" name="language" value="4" id="telugu" />
                                                        <label for="telugu">Telugu</label>
                                                        <input type="checkbox" name="language" value="5" id="chkother" />
                                                        <label for="chkother">Other</label>
                                                        <input type="text" name="language" id="txtOtherChkbx" class="clscheck" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>Address : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <textarea placeholder="Address..." rows="3" cols="41" id="txtAddress" class="form-control"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 clspadd" style=" background-color: ghostwhite;">
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>User Type<span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <select class="form-control" id="ddlUserType">
                                                            <option value="0">Select</option>
                                                            <option value="1" disabled>Admin</option>
                                                            <option value="2" selected>Staff</option>
                                                            <option value="3">Student</option>
                                                            <option value="4">Co-ordinators</option>
                                                            <option value="5">Others</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group specialization" style="display:none">
                                            <div class="col-sm-8 ">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>Specialization<span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <select class="form-control" id="ddlSubjectsType">
                                                            <option value="0">Select</option>
                                                            <option value="1" selected>General Knowledge</option>
                                                            <option value="2">Cyber Security</option>
                                                            <option value="3">Politics</option>
                                                            <option value="4">Pshychology</option>
                                                            <option value="5">Philontrophy</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>UserId <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="text" name="UserId" id="txtUserId" class="form-control" value="Robert@Test" data-validation-required-message="UserId is required" required />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>Password <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="password" name="password" id="txtPassword" value="Raveendra22" class="form-control" data-validation-required-message="Password is required" required />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row control-group">
                                                    <div class="col-sm-4">
                                                        <label>Confirm Password <span class="text-danger">*</span> : </label>
                                                    </div>
                                                    <div class="col-sm-8 controls">
                                                        <input type="password" name="password" id="txtConfirmPass" value="Raveendra22" class="form-control" data-validation-required-message="Confirm Password is required" required />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>Country : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <select id="ddlCounty" onclick="fnBindStates();" class="form-control">
                                                            <option value="0">Select</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col-sm-8">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <label>State : </label>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <select id="ddlState" class="form-control">
                                                            <option value="">Select State</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group position-absolute">
                                            <input type="reset" name="button" value="Reset" class="btn btn-primary clsbtn pull-right" onclick="fnReset();" />
                                            <input type="submit" name="button" value="Save" class="btn btn-primary clsbtn" />
                                        </div>
                                    </div>
                                </div>

                                <div class="row form2">
                                    <div class="col-sm-6">
                                        <div class="row form-group">
                                            <div class="col-sm-12 upload-img">
                                                <div class="row">
                                                    <div class="col-sm-3">
                                                        <label>Picture : </label>
                                                    </div>
                                                    <div class="col-sm-9">
                                                        <div class="row">
                                                            <div class="col-sm-6">
                                                                <input style="margin-left:-21px;" type="file" name="txtPicture" id="txtPicture" />
                                                                @*<input type="file" id="myFile" name="myFile" />*@
                                                                <asp:Button runat="server" ID="btnUpload" Text="Upload" />
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <div class="img-responsive">
                                                                    <img id="user_img" height="120" width="120" style="border:solid;display:none" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
         
        </div>

    </div>
</body>
</html>

<script src="~/Scripts/jquery-3.5.1.min.js"></script>
<script src="~/Scripts/bootstrap.js"></script>
<script src="~/Scripts/jqBootstrapValidation.js"></script>
<script src="https://cdn.bootcss.com/select2/3.4.5/select2.min.js"></script>
<script src="~/Scripts/toast.js"></script>
<link href="~/Content/bootstrap-datepicker.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap-datepicker.min.js"></script>

<script type="text/javascript">
    $(function () {
        $('[data-toggle="datepicker"]').datepicker({
            format: "mm/dd/yyyy",
            autoclose: true           
        });
        $('[data-toggle="datepicker"]').datepicker('setDate', new Date());

        $("#txtOtherChkbx").hide();
        $('#chkother').on("click", function () {
            if ($("#chkother").is(':checked') == true) {
                $("#txtOtherChkbx").show();
            } else {
                $("#txtOtherChkbx").hide();
            }
        });

        //$('.upload-img').prop('display', 'none');
        $('.upload-img').hide();

        $('#ddlCounty,#ddlState').select2({});

        $("#ddlUserType").change(function () {
            
            if ($('#ddlUserType').val() == "2") {
                $('.specialization').css('display', 'block');
            } else { $('.specialization').css('display', 'none'); }
        });

        $('#txtConfirmPass').change(function () {
            if ($('#txtPassword').val() != $('#txtConfirmPass').val()) {
                $.toast({ heading: 'Password and Confirm Password doesnt match.', position: 'top-right', icon: 'error', hideAfter: 6000, stack: 6 });
            }
        });

        $("#txtPicture").change(function () {
            var length = this.files.length;
            if (!length) {
                return false;
            }
            useImage(this);
        });
                
        $('#form-register').find('input,select,textarea').jqBootstrapValidation({
            preventSubmit: true,
            submitError: function ($form, event, errors) {
                /* ... */
            },
            submitSuccess: function ($form, event) {
                if ($('#txtPassword').val() == $('#txtConfirmPass').val()) {
                    debugger;
                    fnSave();
                } else {
                    $.toast({ heading: 'Password and Confirm Password doesnt match.', position: 'top-right', icon: 'error', hideAfter: 6000, stack: 6 });
                    return false;
                }
            },
            filter: function () {
                return $(this).is(":visible");
            }
        });

        fnloadCountry();
    });

    // function to display image
    function useImage(img) {
        var file = img.files[0];
        var imagename = file.name;
        var imagefile = file.type;
        
        var match = ["image/jpeg", "image/png", "image/jpg"];
        if (!((imagefile == match[0]) || (imagefile == match[1]) || (imagefile == match[2]))) {
            //alert("Invalid File Extension");
            $.toast({ heading: 'Invalid File Extension.', position: 'top-right', icon: 'error', hideAfter: 6000, stack: 6 });

        } else {
            var reader = new FileReader;
            var image = new Image;
            reader.readAsDataURL(file);

            reader.onload = function (_file) {
                
                image.src = _file.target.result;
                image.onload = function () {
                    
                    var height = this.height;
                    var width = this.width;
                    var size = (this.size / 1023) + "KB";
                    $('#user_img').attr('src', _file.target.result).css('display','block');
                }
            }
        }           
    }

    function fnloadCountry() {
        $.post('/Home/GetCountryNames', {}, function (data) {
            var objCounty = data.countries;
            if (objCounty != undefined && objCounty.length > 0) {
                $('#ddlCounty').find('option').remove();
                $('#ddlCounty').append('<option value="">Select</option>');
                var optionhtml = "";
                $.each(objCounty, function (e) {
                    optionhtml = '<option value="' + objCounty[e].ID + '">' + objCounty[e].CountryName + '</option>';
                    $('#ddlCounty').append(optionhtml);
                });
            } else {
                $('#ddlCounty').append('<option value="">--Select Country..</option>');
            }
        });
    }

    function fnBindStates() {
        $.post('/Home/GetStateNames', { CountryID: $('#ddlCounty').val() }, function (data) {
            var objState = data.states;            
            if (objState != undefined && objState.length > 0) {
                $('#ddlState').find('option').remove();
                var optionhtml = "";
                $.each(objState, function (s) {
                    //var statenm = $.trim(objState[s].StateName.toLowerCase().replace(/\s/g, ''));
                    optionhtml = '<option value="' + objState[s].ID + '">' + objState[s].StateName + '</option>';
                    $('#ddlState').append(optionhtml);
                });
            } else {
                $('#ddlState').append('<option value="">--Select State--</option>');
            }

        });
    }

    function fnSave() {
        
        try {
            var lang = new Array();
            $("input[type=checkbox]").each(function () {
                if ($(this).is(":checked"))
                    lang.push($(this).val())
            });
            //var formdata = new FormData();
            ////formdata.append("Base64string", $('#user_img').attr('src').replace('data:image/', '').replace(/png|jpg|jpeg|bmp|tiff|gif/, '').replace(';base64,', ''));
            //formdata.append("ID", $("#hdnProviderID").val());
            
            var formdata = {
                FirstName: $('#txtfName').val(),
                LastName: $('#txtlName').val(),
                //DOB: $('#dtDOB').val(),
                Email: $('#txtEmail').val(),
                PhoneNo: $('#txtPhNo').val(),
                Gender: $('input[name="gender"]:checked').val(),
                Language: lang.join(","),//$("input[name='language']:checked").val(),
                OtherLanguage: $('#txtOtherChkbx').val(),
                Address: $('#txtAddress').val(),
                //file: document.getElementById('txtPicture').files[0].name,
                //file: $('#user_img').attr('src').replace('data:image/', '').replace(/png|jpg|jpeg|bmp|tiff|gif/, '').replace(';base64,', ''),
                //Picture: document.getElementById('txtPicture').files[0].name,
                UserType: $('#ddlUserType').val(),
                UserId: $('#txtUserId').val(),
                Password: $('#txtPassword').val(),
                ConfirmPassword: $('#txtConfirmPass').val(),
                Country: $('#ddlCounty').val(),
                State: $('#ddlState').val()
            }
            debugger;
            $.post('/Home/SaveRegistry', formdata, function(data) {
                debugger;
                //$('.upload-img').show();
                //$('.main-page').hide();
                var objdata = data.result;
                alert(objdata); 
                if (objdata != "0") {
                    $.toast({ heading: 'Successfully Registered.', position: 'top-right', icon: 'success', hideAfter: 6000, stack: 6 });
                //    window.location = "../Home/Index";
                //$('.upload-img').show();
                //$('.main-page').hide();
                    debugger;
                }
            });
        } catch (e) {
            alert(e);
        }
    }

    function fnReset() {
        $("#form-register")[0].reset();
        $('#user_img').css('display', 'none');
        $('.help-block').reset;
    }
</script>